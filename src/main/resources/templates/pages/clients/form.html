<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="layout/main :: layout(~{::content}, 'Cliente')">

<section th:fragment="content">

    <!-- HEADER -->
    <div class="mb-6">
        <h1 class="text-2xl font-bold"
            th:text="${client.id == null ? 'Nuevo Cliente' : 'Editar Cliente'}">
        </h1>
        <p class="text-gray-500 text-sm">
            Complete la informaciÃ³n del cliente
        </p>
    </div>

    <!-- FORM -->
    <form th:action="${client.id == null ? '/clients' : '/clients/' + client.id}"
          method="post"
          class="bg-white p-8 rounded-lg shadow max-w-3xl">

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- DNI/CUIT -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    DNI/CUIT
                </label>
                <input type="text"
                       name="nationalId"
                       th:value="${client.nationalId}"
                       placeholder="Ej: 12345678"
                       required
                       class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                       th:classappend="${nationalIdError} ? ' border-red-500 ring-1 ring-red-500' : ''"/>
                <p class="text-sm text-red-600 mt-1"
                   th:if="${nationalIdError}"
                   th:text="${nationalIdError}"></p>
            </div>

            <!-- Dirección -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Dirección
                </label>
                <input type="text"
                       name="address"
                       th:value="${client.address}"
                       placeholder="Ej: Av. Siempre Viva 742"
                       class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"/>
            </div>

            <!-- Teléfono -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Teléfono
                </label>
                <input type="text"
                       name="phone"
                       th:value="${client.phone}"
                       placeholder="+54 9 11 1234 5678"
                       class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"/>
            </div>

            <!-- Zona -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Zona
                </label>
                <select name="zone.id"
                        class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">Seleccionar zona</option>
                    <option th:each="zone : ${zones}"
                            th:value="${zone.id}"
                            th:selected="${client.zone != null && zone.id == client.zone.id}"
                            th:text="${zone.address + (zone.number != null ? ' ' + zone.number : '')}">
                    </option>
                </select>
            </div>

            <!-- Nombre -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Nombre
                </label>
                <input type="text"
                       name="firstName"
                       th:value="${client.firstName}"
                       placeholder="Juan"
                       required
                       class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"/>
            </div>

            <!-- Apellido -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Apellido
                </label>
                <input type="text"
                       name="lastName"
                       th:value="${client.lastName}"
                       placeholder="Perez"
                       required
                       class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"/>
            </div>

            <!-- Vendedor asignado -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Vendedor asignado
                </label>
                <select name="seller.id"
                        required
                        class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">Seleccionar vendedor</option>
                    <option th:each="vendor : ${vendors}"
                            th:value="${vendor.id}"
                            th:selected="${client.seller != null && vendor.id == client.seller.id}"
                            th:text="${vendor.email}">
                    </option>
                </select>
            </div>

            <!-- Email -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Email
                </label>
                <input type="email"
                       name="email"
                       th:value="${client.email}"
                       placeholder="cliente@mail.com"
                       class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"/>
            </div>

            <!-- Fecha nacimiento -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Fecha nacimiento
                </label>
                <input type="date"
                       name="birthDate"
                       th:value="${client.birthDate}"
                       class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"/>
            </div>

            <!-- Cliente recomendado por -->
            <div>
                <label class="block text-sm font-semibold mb-1">
                    Cliente recomendado por
                </label>
                <select name="recommendedBy.id"
                        class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">Sin recomendación</option>
                    <option th:each="recommender : ${recommendedByOptions}"
                            th:value="${recommender.id}"
                            th:selected="${client.recommendedBy != null && recommender.id == client.recommendedBy.id}"
                            th:text="${recommender.nationalId + ' - ' + recommender.firstName + ' ' + recommender.lastName}">
                    </option>
                </select>
            </div>

        </div>

        <!-- Observaciones -->
        <div class="mt-6">
            <label class="block text-sm font-semibold mb-1">
                Observaciones
            </label>
            <textarea name="observations"
                      rows="4"
                      class="w-full border rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      th:text="${client.observations}"></textarea>
        </div>

        <!-- FOOTER ACTIONS -->
        <div class="flex justify-between items-center mt-8 pt-6 border-t">

            <a th:href="@{/clients}"
               class="text-gray-600 hover:text-gray-900">
                <-- Volver al listado
            </a>

            <div class="flex gap-3">
                <a th:href="@{/clients}"
                   class="px-5 py-2 rounded border border-gray-300 hover:bg-gray-100">
                    Cancelar
                </a>

                <button
                        class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 shadow">
                    Guardar Cliente
                </button>
            </div>

        </div>

    </form>

</section>
</html>
